<form [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <div class="profile-header">
        <img [src]="profilePicturePreview || 'http://localhost:3000/uploads/default.png'" alt="Profile Picture" class="profile-picture">
        <div class="form-group">
            <label for="profilePicture">Profile Picture</label>
            <input type="file" id="profilePicture" (change)="onFileSelected($event)">

            <div *ngIf="userForm.get('profilePicture')?.errors && userForm.get('profilePicture')?.touched" class="error">
                <small *ngIf="userForm.get('profilePicture')?.errors?.['pictureType']">
                    Only PNG and JPG file formats are allowed.
                </small>
                <small *ngIf="userForm.get('profilePicture')?.errors?.['minDimensions']">
                    The picture is too small. Minimum dimensions are 100x100px.
                </small>
                <small *ngIf="userForm.get('profilePicture')?.errors?.['maxDimensions']">
                    The picture is too big. Maximum dimensions are 300x300px.
                </small>
                <small *ngIf="userForm.get('profilePicture')?.errors?.['invalidPicture']">
                    The choosen file is not a picture.
                </small>
            </div>
        </div>
    </div>
    <div class="form-row">
        <div class="form-group"><label>Name</label><input formControlName="name"></div>
        <div class="form-group"><label>Surname</label><input formControlName="surname"></div>
    </div>
    <div class="form-row">
        <div class="form-group"><label>Username</label><input formControlName="username"></div>
        <div class="form-group" *ngIf="!isProfilePage">
            <label>Password</label>
            <input type="password" formControlName="password">
            <div *ngIf="userForm.get('password')?.invalid && userForm.get('password')?.touched"
                class="error-message">
                <small *ngIf="userForm.get('password')?.errors?.['pattern']">
                    Password must have 6-10 characters, 1 uppercase, 3 lowercase, 1 number and 1 special character.
                </small>
            </div>
        </div>
    </div>
    <div class="form-group"><label>Address</label><input formControlName="address"></div>
    <div class="form-group"><label>Phone Number</label><input formControlName="phoneNumber"></div>
    <div class="form-group"><label>Email</label><input type="email" formControlName="email"></div>
    <div class="form-group">
        <label for="creditCardNumber">Credit Card Number</label>
        <div class="input-with-icon">
            <input type="text" formControlName="creditCardNumber" id="creditCardNumber" (input)="onCardNumberInput($event)">
            <span class="card-icon">
                <img *ngIf="detectedCardType === 'diners'" src="/assets/icons/diners.png" alt="Diners Club">
                <img *ngIf="detectedCardType === 'mastercard'" src="/assets/icons/mastercard.png" alt="Mastercard">
                <img *ngIf="detectedCardType === 'visa'" src="/assets/icons/visa.png" alt="Visa">
            </span>
        </div>
        <div *ngIf="userForm.get('creditCardNumber')?.errors && userForm.get('creditCardNumber')?.touched" class="error">
            <small *ngIf="userForm.get('creditCardNumber')?.errors?.['required']">Credit card number is required.</small>
            <small *ngIf="userForm.get('creditCardNumber')?.errors?.['luhnInvalid']">The credit card number is invalid</small>
        </div>
    </div>
    <div class="form-row" *ngIf="!isProfilePage">
        <div class="form-group">
            <label>Gender</label>
            <select formControlName="gender">
                <option value="M">Male</option>
                <option value="F">Female</option>
            </select>
        </div>
        <div class="form-group">
            <label>User Type</label>
            <select formControlName="userType">
                <option value="tourist">Tourist</option>
                <option value="owner">Owner</option>
            </select>
        </div>
    </div>

    <div class="button-group">
        <button type="submit" [disabled]="userForm.invalid">
            {{ isProfilePage ? 'Save Changes' : (editMode ? 'Update User' : 'Submit') }}
        </button>
    </div>
</form>